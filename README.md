# PrivateGPT Legal AI - Professional Document Analysis System

**Version:** 2.0  
**Target:** Legal professionals and law firms  
**Focus:** Data sovereignty, compliance, and comprehensive audit trails

## ğŸ“‹ Overview

PrivateGPT Legal AI is a self-hosted AI assistant specifically designed for legal professionals. It provides secure document analysis, RAG-powered Q&A, and comprehensive compliance monitoring without any third-party data egress.

### ğŸ¯ Key Features

- **ğŸ”’ Data Sovereignty:** Fully self-hosted with zero third-party LLM API calls
- **âš–ï¸ Legal Compliance:** 7-year audit trails, attorney-client privilege protection
- **ğŸ§  Advanced RAG:** Automatic document chunking with Weaviate and BGE embeddings
- **ğŸš€ One-Command Setup:** Complete system installation including Docker and dependencies
- **ğŸ“Š Comprehensive Monitoring:** Grafana dashboards with legal-specific metrics
- **ğŸ” Security:** JWT authentication with role-based access control

## ğŸ—ï¸ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Legal AI System                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Traefik Gateway (Port 80)                                â”‚
â”‚  â”œâ”€â”€ /           â†’ Streamlit UI                           â”‚
â”‚  â”œâ”€â”€ /grafana    â†’ Monitoring Dashboards                 â”‚
â”‚  â”œâ”€â”€ /n8n        â†’ Document Processing                   â”‚
â”‚  â””â”€â”€ /prometheus â†’ System Metrics                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Core Services                                             â”‚
â”‚  â”œâ”€â”€ ğŸ§  Ollama (LLaMA-3 8B/70B)                          â”‚
â”‚  â”œâ”€â”€ ğŸ—ƒï¸ Weaviate (Auto-chunking Vector DB)                â”‚
â”‚  â”œâ”€â”€ ğŸ” JWT Auth Service                                   â”‚
â”‚  â”œâ”€â”€ ğŸ“„ n8n Document Processing                           â”‚
â”‚  â””â”€â”€ ğŸ“Š Monitoring Stack (Grafana + Prometheus + Loki)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Quick Start

### Prerequisites

- **Hardware:** Linux server with GPU support (RTX 4090 or A100 recommended)
- **OS:** Ubuntu 20.04+, Debian 10+, CentOS 7+, Fedora 30+, or compatible
- **User:** Non-root user with sudo privileges (or root access)
- **Network:** Internet connection for downloading dependencies

**Note:** The setup script will automatically install Docker, Docker Compose, and all system dependencies.

### 1. Clone and Setup

```bash
git clone <repository-url>
cd privategpt

# Make setup script executable
chmod +x setup.sh

# Run complete setup (installs everything)
./setup.sh
```

The setup script will automatically:
- âœ… Update system packages (apt/yum/dnf)
- âœ… Install Docker and Docker Compose
- âœ… Install NVIDIA Container Toolkit (if GPU detected)
- âœ… Configure Docker for current user
- âœ… Set up environment variables with secure defaults
- âœ… Deploy all services via Docker Compose
- âœ… Download the LLaMA-3 8B model
- âœ… Verify installation and provide access information

### 2. Alternative: Manual Setup

If you prefer manual control or the automatic setup fails:

```bash
# Copy environment template
cp env.example .env

# Edit environment variables
nano .env

# Deploy services manually
docker-compose up -d

# Download model
docker exec -it ollama-service ollama pull llama3:8b
```

### 3. Configure Environment (Optional)

The setup script generates secure defaults, but you can customize `.env`:

```bash
# Security (Auto-generated secure values)
JWT_SECRET_KEY=<auto-generated-64-char-hex>
WEAVIATE_API_KEY=<auto-generated-32-char-hex>
GRAFANA_ADMIN_PASSWORD=<auto-generated-secure-password>
N8N_PASSWORD=<auto-generated-secure-password>

# Models
OLLAMA_MODEL_DEV=llama3:8b      # Development
OLLAMA_MODEL_PROD=llama3:70b    # Production (requires ~40GB VRAM)
```

### 4. Access the System

After setup completion, access your Legal AI system:

- **ğŸŒ Main Application:** http://localhost/
- **ğŸ“Š Monitoring Dashboard:** http://localhost/kibana
- **ğŸ”„ Document Workflows:** http://localhost/n8n
- **ğŸ“‹ Log Analysis:** http://localhost/kibana/app/discover

**Default Login:** `admin@legal-ai.local` / `admin`

The setup script displays all generated passwords and access information.

### 5. Post-Installation

```bash
# Create admin user (optional - default exists)
curl -X POST http://localhost/api/auth/create-user \
  -H "Content-Type: application/json" \
  -d '{
    "email": "admin@yourfirm.com",
    "password": "SecurePassword123!",
    "role": "admin",
    "client_matters": ["General", "ClientA_Matter1"]
  }'

# Check system status
docker-compose ps

# View logs if needed
docker-compose logs -f
```

**ğŸ”§ Troubleshooting Docker Issues:**

If you see Docker connection errors:
```bash
# Refresh Docker group membership
newgrp docker

# Or restart Docker service
sudo systemctl restart docker

# Check Docker status
sudo systemctl status docker
```

## ğŸ› ï¸ System Requirements

### Minimum Requirements
- **CPU:** 4 cores
- **RAM:** 16GB
- **Storage:** 200GB SSD
- **GPU:** Optional (CPU-only mode available)

### Recommended for Production
- **CPU:** 8+ cores
- **RAM:** 32GB+
- **Storage:** 500GB+ NVMe SSD
- **GPU:** RTX 4090 (24GB) or A100 (40GB/80GB)

### Supported Operating Systems
- Ubuntu 20.04 LTS or newer
- Debian 10 (Buster) or newer
- CentOS 7/8/Stream
- RHEL 7/8/9
- Fedora 30 or newer
- Amazon Linux 2

## ğŸ“Š Monitoring & Compliance

### Legal Compliance Features

âœ… **7-year audit log retention**  
âœ… **Attorney-client privilege protection**  
âœ… **Client matter data segregation**  
âœ… **Comprehensive activity tracking**  
âœ… **Security incident monitoring**  
âœ… **Billable time integration**

### Key Metrics Monitored

- Authentication events and security alerts
- Document access with user/matter tracking
- AI query logging with source attribution
- System performance and availability
- Compliance violations and investigations

### ELK Stack Dashboards

1. **System Monitor Dashboard:** Container logs, service health, performance metrics
2. **Log Discovery:** Real-time log analysis and search capabilities
3. **Compliance Dashboard:** Audit trails, security events, legal-specific metrics

## ğŸ”§ Configuration

### User Management

```bash
# Create new user (admin only)
curl -X POST http://localhost/api/auth/create-user \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "attorney@firm.com",
    "password": "SecurePass123!",
    "role": "partner",
    "client_matters": ["ClientX_Contract2024"]
  }'
```

### Document Processing

The system automatically:
1. Extracts text from PDF/DOCX/TXT files
2. Sends full documents to Weaviate for auto-chunking
3. Generates embeddings using BGE model
4. Makes documents searchable within minutes

### RAG Configuration

- **Model:** LLaMA-3 8B (dev) / 70B (prod)
- **Embeddings:** BGE (CPU-based for cost efficiency)
- **Chunking:** Automatic via Weaviate
- **Context:** Top 3 relevant document chunks per query

## ğŸ›¡ï¸ Security

### Multi-Layer Security

- **Authentication:** JWT with 8-hour expiration
- **Authorization:** Role-based access control
- **Data Protection:** LUKS disk encryption
- **Network:** Docker network isolation
- **Monitoring:** Failed login detection and alerting

### Compliance Controls

- **Data Retention:** 7-year policy for legal compliance
- **Access Control:** Client matter segregation
- **Audit Trails:** Immutable logging with PII redaction
- **Privacy:** No third-party data egress

## ğŸ’° Cost Analysis

### Development Environment
- **Hardware:** RTX 4090 (~$0.50/hour)
- **Monthly Cost:** $300-600
- **Use Case:** Testing, training, proof-of-concept

### Production Environment
- **Hardware:** A100 80GB (~$1.89/hour)
- **Monthly Cost:** $600-1200
- **Use Case:** Live legal research, client work

### Cloud Provider Recommendations

| Provider | Cost (A100) | Pros | Best For |
|----------|-------------|------|----------|
| **RunPod** | $1.89/hr | ML-focused, reliable | Production |
| **Vast.ai** | $1.20/hr | Cheapest option | Development |
| **Lambda Labs** | $1.10/hr | ML-optimized | Production |

## ğŸ” Troubleshooting

### Common Issues

**ğŸš¨ Service Won't Start**
```bash
# Check logs
docker-compose logs service-name

# Restart specific service
docker-compose restart service-name
```

**ğŸš¨ GPU Not Detected**
```bash
# Verify NVIDIA runtime
docker run --gpus all nvidia/cuda:11.0-base nvidia-smi

# Check Docker daemon.json
cat /etc/docker/daemon.json
```

**ğŸš¨ Authentication Failing**
```bash
# Reset admin password
docker exec -it auth-service python -c "
from auth_service import hash_password
print(hash_password('newpassword123'))
"
```

### Health Checks

```bash
# System health
curl http://localhost/health

# ELK Stack health
curl http://localhost:9200/_cluster/health

# Service status
docker-compose ps

# Resource usage
docker stats
```

## ğŸ“ˆ Scaling & Production

### Performance Optimization

1. **GPU Model Selection**
   - Development: LLaMA-3 8B (4GB VRAM)
   - Production: LLaMA-3 70B (40GB VRAM)

2. **Storage Optimization**
   - Use NVMe SSDs for database storage
   - Implement log rotation policies
   - Regular backup verification

3. **Network Optimization**
   - Use CDN for static assets
   - Implement caching strategies
   - Monitor bandwidth usage

### Production Checklist

- [ ] Change all default passwords
- [ ] Configure backup procedures
- [ ] Set up monitoring alerts
- [ ] Implement log rotation
- [ ] Configure firewall rules
- [ ] Set up SSL certificates
- [ ] Document emergency procedures

## ğŸ›£ï¸ Roadmap

### Phase 1 (Months 1-3)
- [ ] LLaMA-3 70B production deployment
- [ ] Enhanced Grafana dashboards
- [ ] Advanced user management UI
- [ ] Document upload via web interface

### Phase 2 (Months 3-6)
- [ ] Fine-tuning on legal corpus
- [ ] Multi-tenant architecture
- [ ] Advanced security features (MFA)
- [ ] API endpoints for integrations

### Phase 3 (Months 6-12)
- [ ] SaaS offering capabilities
- [ ] E-discovery workflow integration
- [ ] Professional liability insurance integration
- [ ] Advanced compliance automation

## ğŸ“ Support

### Documentation
- [Design Documents](./mind/privategpt_mind/)
- [API Documentation](./docs/api/)
- [Compliance Guide](./docs/compliance/)

### Community
- **Issues:** Create GitHub issues for bugs
- **Discussions:** Join community discussions
- **Security:** Report security issues privately

---

**âš–ï¸ Legal Notice:** This system is designed for legal professionals. All AI-generated content should be reviewed by qualified attorneys. The system does not constitute legal advice and should not be relied upon as such.

**ğŸ”’ Privacy:** This system operates with complete data sovereignty - no data leaves your infrastructure. 